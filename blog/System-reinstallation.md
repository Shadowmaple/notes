# 系统重装日记

# 前言

第一次装上的 ubuntu 分配的磁盘空间大小严重不妥，挂载点贼多（/、/usr、/opt、/home、/boot等等），基本上能挂载的都挂载了，这不是问题，问题是这些挂载的目录所分配的空间严重不均，如`/usr`有40G，而`/home`只有9.6G，`/usr`和`opt`也极少，忘了具体多少了，反正之后导致的结果就是不时的会弹出消息：`/usr`空间只有200mb了，`/home`只有500MB了，`opt`又只有几百MB了……之前的临时性办法只有清除一些文件，典型的治标不治本，最后在制作 docker镜像 的时候实在是忍无可忍，便重装了。

# 备份

该备份的要先备份好，U盘的文件要备份，因为制作启动盘的时候会讲U盘格式化。有必要的话还要把`/home`目录内的文件备份，一个个备份实在麻烦，可以将整个目录备份，也因为`/home`是一个挂载点，所以既可以以linux文件系统的方式备份，也可以以磁盘方式备份（如DiskGenius 软件），我选择了不破不立，破而后立——`/home`内的都不要了。

# 制作U盘镜像

首先要去下载一个镜像文件，官方的下载很慢，可以去阿里或网易等开源镜像网站下载

> http://mirrors.163.com/ubuntu-releases/18.04.3/

下载 `ubuntu-18.04.3-desktop-amd64.iso`文件，也就2G不到，下载很快。

然后制作U盘镜像，可以在linux上用dd命令方法，也可以用第三方软件，我是在windows上用ubuntu官方推荐的Rufus工具的。

下载[Rufus工具](https://rufus.ie/en_IE.html)。

打开Rufus，插入U盘，选择下载下来的ubuntu镜像文件，其它的选项基本上就默认就可以了，之前还纠结好久。分区类型MBR，文件系统FAT32，其实文件系统 NTFS 比FAT32好的多，也可以选择NTFS。

点击开始等几分钟就制作完成。

# 磁盘合并

因为不知道ubuntu安装默认的第一个覆盖安装是会根据原来的磁盘分配方式安装，还是会格式化、合并磁盘再安装，所以我打算直接手动讲之前散乱的磁盘分区合并，之后安装的时候再自己分配。

再windows上讲 ubuntu 的分区逐一删除，然后就有一个大型的未分配空间，很好，这就是我想要的。如果不确定是不是ubuntu的话，就在 DiskGenius 查看分区信息，可以看到挂载点等信息。

# 进入Bios

这一块困扰我好长时间，根据对应的电脑机型看网上的都是按 F2 的，但是并无软用，进入的是一个 System Config ，按 F12 倒是进入了Boot，但是没有在选项中看到 USB 选项，只看到UEFI选项，以为不是这个（这记性，曾经看过的书都白看了，都忘了UEFI引导了）……后来还是在朋友的“引导”下点了进去……

期间，发现一个 Fn 键的问题，本来在笔记本上是要按 Fn 才会体现 F1—F12 的功能，但是 Esc 可以锁定 Fn ，就可以不用按 Fn ，直接就可以有 F1—F12 的功能了。这也是一个阻扰我进入bios的问题。

# 安装Ubuntu

在进入u盘启动选项选择使用ubuntu还是直接安装ubuntu的时候，要选择试用！进入ubuntu后再安装。不然直接安装的话要退出的话退出不了，只能强制关机，而且还不能选择安装引导的语言，只能用英文！

进入ubuntu，安装，选择简体中文，之后要改英文的话再改，在安装的时候还是中文方便。

“更新和其他软件”，最小安装，其余的默认即可。安装类型选择其他选项，自己分配分区和设置挂载点，我这次是打算分配根目录35GB，swap交换空间8GB，其它都给home目录，大概60GB（实在是穷怕了），总共大概100GB的磁盘空间。

选择未分配的空间，看大小，别选错了。点击左下角的 + 号，或者双击。设置：

1. 35000MB，主分区，Ext4日志文件系统，挂载点 `/`
2. 8000MB，逻辑分区，交换空间，/swap
3. 全部，主分区，Ext4，/home

分区位置都是空间起始位置即可。

对于新手来说，主分区和逻辑分区在ubuntu其实不需要分得太清，只要有主分区就可以了，比如根目录为主分区，其它都为逻辑分区，或者全部都是主分区都行。但是不要为扩展分区，因为扩展分区不是用于存储数据的，主分区和逻辑分区才可以存储实际的数据。另外，在一个磁盘中，主分区最多只能有四个，不能超过四个主分区。

再然后就没什么问题了，设置用户名密码之类的，密码好像之后再改的话不能改短。

再等上一段时间。如果没什么问题这样就算安装好了。之后的配置又非常的麻烦。

# 配置

首先更改软件源，应用程序->软件和更新->ubuntu软件->下载自，选择其他站点->中国的中科大(ustc)软件源。

```shell
sudo apt-get update
```

之后下载zsh, terminator,  fitch, 搜狗输入法，chrome浏览器，golang，vscode之类的就不写了，反正网上教程多的是，主要是记录下安装系统过程中的问题和选项，配置几乎没什么难度，就是比较麻烦。



# 总结

纠结了多“年”，总算是决定重装了，花了一天的时间也总算是装好、配置好了。几乎回到了重装之前的模样，几乎？因为github博客还要重新弄弄，打算就不用hexo了，换个hugo试试。

在装了一遍系统之后，再回头看看之前的那些看了就忘的文件系统、磁盘分区之类的知识，发现另有一番理解。这一次重装，想想还是挺有收获的。不过，正如大咖所说的，没有装过10次以上的系统，不能说懂了Linux。任重道远呐……