# 微服务简介

标签：微服务

---

## 单体架构

为了更好的说明微服务，先来说下单体架构。

单体架构就是传统的开发模式，即将应用写在同一个目录下，一次部署。

固然这种开发方式是最快最方便的，但随着开发层次的深入、应用的逐次迭代，代码也不可避免的变得非常庞大、复杂，最终变成难以理解的一个“怪物”。

缺点：

+   部署时间长。当对一个bug进行修复后要重新进行部署，由于是单体应用，所以就导致全部代码都要一起部署。
+   迭代和维护困难。代码过于庞大和复杂，造成二代开发者理解困难，迭代困难，难以维护。许多公司的项目就是因为迭代和拆分太过困难而被迫放弃尝试
+   代码之间耦合性高，牵一发而动全身。难以处理各部分之间的关系，维护困难，并且可能因为一个微小的问题，导致整个应用挂掉。
+   无法按需伸缩，扩展性差。比如搜索服务的压力大，需要水平扩展，但因为是单体应用，只能整个应用进行水平扩充。

正是这些缺陷使得单体架构随着应用愈发壮大而注定要被抛弃，也呼唤一种新的架构模式的出现。

>   当然在微服务之前还有一些其它的解决方案，微服务也是在SOA架构的基础上发展起来的。

## 什么是微服务

顾名思义，就是体积“微”小的服务，即把一个大的单体应用拆分成多个小的服务，各个小服务都算得上是一个独立的应用，独立开发，独立部署，独立迭代。客户端和这些服务之间有一个 API Geteway，用于统一转发客户端的请求，底层的服务对于客户端来说是透明的。



![](https://camo.githubusercontent.com/0e5aaa7d8d99e07cfb074601dadaddf33e56e4bd/68747470733a2f2f646f63732e6d6963726f736f66742e636f6d2f656e2d75732f617a7572652f6172636869746563747572652f67756964652f6172636869746563747572652d7374796c65732f696d616765732f6d6963726f73657276696365732d6c6f676963616c2e737667)



## 特点

+   高内聚，低耦合。
+   各个服务独立开发、独立部署。独立开发不仅仅是指开发人员单独对这个模块进行开发，还指该服务可以使用不同的开发技术。
+   统一的API Gateway转发请求。
+   服务之间使用轻量级通信协议来通信。
    +   RESTful（HTTP协议）
    +   RPC
    +   异步通信（Kafaka，Redis）

## 优势

+   **模块分离，便于敏捷开发、功能拓展和项目维护。**单个微服务内部的实现对其它微服务而言是透明的，所以只要接口约定好了，那么就可以尽情的实现优化和功能扩展。而单个微服务规模更小，代码容易理解，因此维护的难度更低。

+   **独立部署效率高，局部的修改更容易部署。**如果只是设计单个服务内部的问题，只要单独对其进行修复然后单独部署就可以了，更加方便和高效。

+   **易于迭代和技术创新。**单个服务可以采用更好的技术来优化、迭代。甚至可以使用不同的开发语言。

+   **易于水平扩展、按需伸缩。**当某个服务压力大时，可以单独对其进行水平扩展。

## 缺点

正如某书中所说的“没有银弹”，微服务也有其自身的缺陷和不足，无法奉为圭臬。

>   “银弹”就是指对某种怪物的最有效的杀伤武器，或称为杀手锏。
>
>   “没有银弹”是指计算机科学家、图灵奖获得者布鲁克斯（Frederick Phillips Brooks,Jr.）提出的一个论断：“没有任何一种单纯的技术或管理上的进步，能够独立地承诺在10年内大幅度地提高软件的生产效率、可靠性和简洁性。”

+   多服务导致部署和运维难度增加。

单体应用只有一个运维对象，但微服务由多个服务组成，当服务数量增多时，不可避免地导致部署和运维难度增大，如Netflix 拥有的服务就超过 600 个。这就导致微服务开发团队必须要具备自动化部署和运维的策略和能力。

+   ~~跨越多个服务，排错困难，测试困难。~~

+   接口调整成本高。

比如用户服务被评论服务和选课调用，一旦用户服务的接口发生变化，那么所有依赖于它的服务都需要做相应的调整。

+   统一的API Gateway 可能会导致单点故障。
+   分布式系统实现的复杂性。
+   ……

## 适用条件

+   易于拆分、模块耦合低的应用。一些诸如偏于底层的应用，各个模块之间耦合度高，就不适用于微服务。
+   各个微服务能够独立地部署。

## 参考

+   https://github.com/vaquarkhan/microservices-recipes-a-free-gitbook
+   https://juejin.im/post/5bf7e9936fb9a049e701c23a#heading-13