
## 四次挥手

client 和 server

为什么不是一次挥手？
如果客户端只发送一次结束帧，那么可能有以下几种情况：
1. 服务器未收到帧，而服务器还处于可发送信息的“半连接”状态，那么仍旧会发送数据给客户端。而此时客户端已经“跑路”了，那么服务器的数据就不知道怎么发送了；而如果很快另起了一个客户端B，同样的端口，那么服务器的数据就会错误地发给客户端B。
2. 服务器收到了帧，如果客户端直接“跑路”了，而服务器还有工作没处理完，这就会强制停止工作
3. 服务器收到了帧，但客户端不知道服务器是否收到，因为怕还会有数据传回来，那么就会一直等，不停发送结束帧，而此时服务器已经关闭了，那么传送的帧就会错误。

为什么不是二次挥手？
1. 如果服务器还有工作未处理完，要等到处理完后才发送确认结束的“挥手”，那么时间会滞留过长，在此过程中，客户端会误以为未收到而持续发送结束帧
2. 如果服务器还有工作未处理完而直接“挥手”，客户端收到确认后直接关闭，那么服务器还是会陷入“半连接”状态

为什么不是三次挥手？
服务器要保证客户端已经收到了结束通知，而避免客户端一直等待服务器处理完工作。如果只挥手三次，那么服务器就不知道客户端是否收到了结束通知
