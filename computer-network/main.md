# 计算机网络

[TOC]

# 网络概论

网络：

+   电信网络
+   有线电视网络
+   计算机网络

平时熟称的网络就是指计算机网络

互联网的两个重要特点：连通性和共享性



互联网发展阶段

第一阶段：单体网络ARPANET

第二阶段：三级网络结构（主干网、地区网、企业网/校园网）

第三阶段：多层次ISP结构

ISP（Internet Service Provider）互联网服务提供者，提供网络服务的主体，如提供校园网的高校

IXP（Internet Exchange Point）互联网交换点



互联网由边缘部分和核心部分组成：

+   边缘部分：用户直接使用的主机
+   核心部分：大量网络和连接的路由器组成



用户端系统之间通信的方式：

+   C/S（client-service客户端-服务器）
+   P2P（peer-to-peer，对等方式）：一台主机既可以是客户端也可是服务器，多台主机之间的关系是平等的



路由器是一种用于分组交换的专用计算机

交换方式：

+   电路交换，如电话
+   报文交换
+   分组交换



网络分类

按作用范围分类：

+   广域网，WAN（Wide Area Network）：几十到几千公里
+   城域网，MAN（Metropolitan Area Network）：5-50km，一般为一个城市
+   局域网，LAN（Local Area Network）：1km左右，校园网或企业网属于多个互连的局域网
+   个人区域网，PAN（Personal AreaNetwork）：10m左右

按网络使用者分类：

+   公用网
+   专用网

## 概念

码元：指一个**固定时长**的**信号波形**，代表不同离散数值的基本波形，是数字通信中数字信号的计量单位。该时长内的信号称为k进制码元，该时长称为码元宽度。一般高低电平表示的数字信号为二进制码元。1码元可以携带多个比特的信息量。

速率：数据率，数据的**传输速率**（不是传播速率），分为码元传输速率和信息传输速率，（一般指信息传输速率）

+   码元传输速率：1s传输的码元数（1码元可能携带多个比特），单位为波特（Baud）
+   信息传输速率：1s传输的比特数，单位为bit/s或bps。

带宽：网络中某通道传输数据的能力，即在单位时间内通道所能通过的**最高速率**，单位为bit/s或bps

吞吐量：单位时间内通过某个网络的实际数据量，单位为bit/s、帧/s

# 物理层

物理层要解决的是如何在连接各种计算机的传输媒体上传输数据比特流，而不是具体的物理设备。

物理层的任务是确定与传输媒体接口有关的一些特性，即标准的定义

+   机械特性
+   电气特性
+   功能特性
+   规程特性

##　信道

信道：信号的传输媒介

信号：

+   基带信号：**来自信源**的信号（比如人发出的声音），在数字信道上传输（基带传输）
+   宽带信号：将基带信号进行调制，把信号的频率提高到较高的频率，避免传输距离过远造成信号的衰减。在模拟信道上传输（宽带传输）

数据可以转换成数字信号和模拟信号。转换成数字信号的过程称为**编码**，转换为模拟信号的过程称为**调制**

数字数据（计算机）可通过调制器转换为模拟信号，也可转为数字信号，模拟数据（声音）可通过PCM编码器转换为数字信号，也可转为模拟信号。

编码方式是人为规定的，常用的有：

+   非归零编码：高电平对应1，低电平对应0
+   归零编码：信号电平在一个码元内都要归为0
+   反向不归零编码：信号电平发生变化为0，不发生变化为1
+   曼彻斯特编码：一个码元分为间隔相等的两部分，前高后低为1，前低后高为0（按具体规定，也可相反）
+   差分曼彻斯特编码：在每个码元中间都有一个跳变，同1异0（指下一个码元）
+   4B/5B编码

调制技术，在发送端将数字信号转为模拟信号（调制），在发送端将模拟信号转为数字信号（解调）：

+   调幅，ASK
+   调频，FSK
+   调相，PSK
+   调幅+调相，QAM

信道利用率：发送方在一个发送周期内，有效地发送数据所需要的时间（因为有延时）占整个发送周期的比率。

## 传输媒介

传输媒介/传输媒体/传输介质，是数据通信系统中数据发送端和接收端之间的物理通路，并不属于物理层的范畴，而在物理层之下。

传输媒介分为导引性传输媒介和非导引性传输媒介。

导向性传输介质：

+   双绞线：按有无屏蔽层可分为屏蔽双绞线和非屏蔽双绞线
+   同轴电缆
+   光纤：光纤通信就是利用光导纤维传递**光脉冲**来进行通信。可分为多模光纤和单模光纤。

非导向型传输介质：

+   无线电波：信号向所有方向传播，较强穿透能力
+   微波：信号固定方向传播
    +   地面微波接力通信：地面中继站
    +   卫星通信：同步卫星，三个即可覆盖全球，但传播时延较高
+   红外线、激光：固定方向，需要把传输的信号转换成各自的信号格式

## 信道复用技术

+   频分复用
+   时分复用
+   统计时分复用
+   波分复用
+   码分复用

# 数据链路层

## 基本概念

**结点**：主机、路由器

**链路**：网络中两个结点之间的**物理通道**

**数据链路**：网络中两个结点之间的**逻辑通道**，把实现**控制数据传输协议的硬件**和软件加加到链路上就构成了数据链路。

**帧**：链路层的协议数据单元，封装网络层的数据报

数据链路层的任务就是通过一条链路从一个结点向另一个物理链路相邻的结点传输数据报。

具体的功能有：

+   为网络层提供服务：无确认无连接服务，有确认无连接服务，有确认有连接服务
+   链路管理：连接的建立、维持、释放（用于面向连接的服务）
+   组帧
+   流量控制：限制发送方
+   差错控制（帧错/位错）

## 封装成帧

封装成帧就是在一段数据报的首尾添加首部和尾部，以构成一个帧。首部和尾部包含许多的控制信息，其作用便是用于帧定界（确定帧的界限）。

每个数据链路层协议都规定了所能传送的帧的**数据部分的长度上限**，即**最大传送单元**（**MTU**，Maximum Transfer Unit）

组帧的四种方法：

+   字符计数法：帧首部使用一个计数字段来标明帧内字符数/字节数
+   **字符（节）填充法**：在数据中含有首尾部控制字符的前面填充一个字节/字符，通常为转义字符
+   **零比特填充法**：在连续的5个1之后填充一个0
+   **违规编码法**：利用两个在（物理层）编码方式（如曼彻斯特编码）中不会用到的编码来界定帧的起始和终止

透明传输，指不管所传数据是什么样的比特组合，都应当能够在链路上传送，链路层看不见任何妨碍数据传输的东西。

当所传数据中的比特组合与某个控制信息一样时，就需要采取某些措施，来避免错误地“截断”帧。

## 差错控制

传输中的差错都是由噪声引起的

+   全局性噪声：由于线路本身电气特性锁产生的随机噪声（热噪声），信道固有且随机存在的。解决办法是提高信噪比。
+   局部性噪声：外界特定的短暂原因所造成的冲击噪声。解决方法是利用编码技术。

差错有：

+   位错（比特差错）：比特位出错，1变成0，0变成1
+   帧错：丢失、重复、失序

在数据链路层中的差错控制主要解决的是比特差错的问题，解决方法有：

+   检错编码：奇偶校验码、**循环冗余码CRC**
+   纠错编码：海明码

ps：上述“编码”是指数据链路层的编码，与物理层的编码不同，它针对的是一组比特，而不是物理层编码针对的单个比特。

使用CRC检验能够实现“无比特差错”的传输，但不能一定实现“无传输差错”，并不是可靠的传输。

## 流量控制

流量控制就是限制发送方的流量发送速率。

数据链路层流量控制功能的应用场景：当较高的发送速度和较低的接收能力不匹配时，会造成传输出错。

传输层也有流量控制的功能，它们的区别：

+   对象不同：数据链路层的流量控制是点对点的，而传输层的流量控制是端到端的。
+   控制手段不同：数据链路层，接收方收不下就不回复确认；传输层，接收端给发送端一个窗口公告。

流量控制的方法：

+   停止-等待协议
+   滑动窗口协议：后退N帧协议（GBN）、选择重传协议（SR）

停止-等待协议很好理解，就是发送端发送一个帧，然后等待接收方的确认，收到确认之后才会再次发送。虽然原理简单，但是信道利用率很低。

滑动窗口协议就是允许发送发传输一串连续的（位于窗口内的）帧，当接收方收到帧时回复确认，当发送方收到窗口最左侧的帧时，窗口就向右滑动，将新的要发送的帧纳入窗口中。

ps：滑动窗口的大小/长度是固定的，不会在传输过程中发生变化



## 信道

数据链路层的信道分为点对点信道和广播信道









# 应用层

## DNS域名系统

每一个域名都是唯一的，有其唯一的层次结构，使用域的命名空间来唯一标识一个域名。域在命名空间中可被管理、划分，一个域其下可划分有子域（一级域、二级域等）。

以`ccnu.edu.cn`为例，`cn`为顶级域名，`edu`为二级域名，`ccnu`为三级域名。

每个域名都由有`.`隔开的标号（英文字母、数字或`-`）组成，英文字母不区分大小写。每个标号不超过63个字符，由多个标号组成的域名总共不超过255个字符。

顶级域名TLD（Top Level Domain）：

+   国家顶级域名ccTLD
+   通用顶级域名nTLD
+   基础结构域名：只有一个arpa，用于反向域名解析，称为反向域名

中国把二级域名划分为类别域名和行政区域名两大类，类别域名有edu、gov、ac（科研机构）等七个。

DNS服务器以**区**为管辖范围，区的划分可以任意。区的范围一定小于或等于域。

域名服务器分为：

+   根域名服务器
+   顶级域名服务器
+   权限域名服务器：每个区的域名服务器称为**权限域名服务器**，用来保存该区所有主机到IP地址的映射。
+   本地域名服务器：不能说每台用户主机就是一个本地域名服务器，而是距离用户主机最近的一个默认域名服务器，只是不超过几个路由器的距离。

域名服务器会有主域名服务器和辅助域名服务器，来提高服务器的可靠性。

域名解析过程：

+   主机向本地域名服务器发起**递归查询**。
+   本地域名服务器向**根域名服务器**发起**迭代查询**或**递归查询**。

域名服务器中广泛使用**高速缓存**，以减轻根域名服务器的载荷和减少互联网上的DNS查询报文的数量。主机也有使用缓存。

## 文件传输协议

文件传输协议主要有FTP、TFTP（Trivial File Transfer Protocol，简单文件传输协议）。FTP使用TCP连接，TFTP使用UDP连接。





